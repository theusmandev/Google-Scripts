function saveFinalFixedCsv() {
  // ------------------------------------------
  // 1ï¸âƒ£ ÙˆÛŒØ¨ Ø³Ø§Ø¦Ù¹Ø³ Ú©ÛŒ Ù„Ø³Ù¹
  // ------------------------------------------
  var WEBSITES = [
    "https://digestlibrary.com/"
  ];

  var FOLDER_ID = ""; 

  // ------------------------------------------
  // 2ï¸âƒ£ ØªØ§Ø±ÛŒØ® Ø§ÙˆØ± Ø³ÛŒÙ¹Ù†Ú¯Ø²
  // ------------------------------------------
  var now = new Date();
  var currentMonth = now.getMonth(); 
  var currentYear = now.getFullYear();
  var folder = DriveApp.getFolderById(FOLDER_ID);

  for (var w = 0; w < WEBSITES.length; w++) {
    var siteUrl = WEBSITES[w];
    if (siteUrl.charAt(siteUrl.length - 1) != '/') siteUrl += '/';
    
    // ÚˆÙˆÙ…ÛŒÙ† Ú©Ø§ Ù†Ø§Ù… Ù†Ú©Ø§Ù„Ù†Ø§
    var domainName = siteUrl.replace(/^https?:\/\//, '').replace(/^www\./, '').split('.')[0];
    Logger.log("------------\nScanning: " + domainName);

    // ğŸ”¥ FIX 1: max-results=500 (ØªØ§Ú©Û 8 ØªØ§Ø±ÛŒØ® ÙˆØ§Ù„ÛŒ Ù¾Ø±Ø§Ù†ÛŒ Ù¾ÙˆØ³Ù¹Ø³ Ø¨Ú¾ÛŒ Ø¢ Ø¬Ø§Ø¦ÛŒÚº)
    var rssUrl = getHighLimitRssUrl(siteUrl);
    
    if (!rssUrl) {
      Logger.log("âŒ Failed: RSS not found for " + domainName);
      continue;
    }

    var csvContent = "Title,Google Drive Link,MediaFire Link,Post URL\n";
    var postsFound = 0;

    try {
      var response = UrlFetchApp.fetch(rssUrl, {muteHttpExceptions: true});
      var xml = response.getContentText();
      var document = XmlService.parse(xml);
      var root = document.getRootElement();
      var channel = root.getChild('channel');
      var items = channel.getChildren('item');

      Logger.log("Total items fetched from RSS: " + items.length);

      for (var i = 0; i < items.length; i++) {
        var item = items[i];
        
        var pubDateStr = item.getChildText('pubDate');
        var pubDate = new Date(pubDateStr);
        
        // ØµØ±Ù Ù…ÙˆØ¬ÙˆØ¯Û Ù…ÛÛŒÙ†Û’ Ú©ÛŒ Ù¾ÙˆØ³Ù¹Ø³ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº
        if (pubDate.getFullYear() === currentYear && pubDate.getMonth() === currentMonth) {
          
          var title = item.getChildText('title');
          var postLink = item.getChildText('link');

          // ----------------------------------------------------
          // ğŸ”¥ DEEP SCAN: Ø§ØµÙ„ Ù¾ÛŒØ¬ Ú©Ú¾ÙˆÙ„ÛŒÚº
          // ----------------------------------------------------
          var fullPageHtml = "";
          try {
            // ÙˆÛŒØ¨ Ø³Ø§Ø¦Ù¹ Ú©Ùˆ Ú©Ø±ÛŒØ´ ÛÙˆÙ†Û’ Ø³Û’ Ø¨Ú†Ø§Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ù…Ø¹Ù…ÙˆÙ„ÛŒ ÙˆÙ‚ÙÛ
            Utilities.sleep(800); 
            var pageResp = UrlFetchApp.fetch(postLink, {muteHttpExceptions: true});
            fullPageHtml = pageResp.getContentText();
          } catch(err) {
            Logger.log("Could not open page: " + postLink);
          }

          // ----------------------------------------------------
          // ğŸ”¥ FIX 2: ØºÙ„Ø· Ù„Ù†Ú©Ø³ (Ads) Ú©Ø§ Ø¹Ù„Ø§Ø¬
          // ----------------------------------------------------
          
          // ØµØ±Ù Ø§ÙˆØ± ØµØ±Ù drive.google.com ÛŒØ§ docs.google.com Ø§Ù¹Ú¾Ø§Ø¦Û’ Ú¯Ø§
          var gDriveLink = findSpecificLink(fullPageHtml, /(https?:\/\/(drive|docs)\.google\.com\/[^"'\s<>]+)/i);
          
          // Ù…ÛŒÚˆÛŒØ§ ÙØ§Ø¦Ø±
          var mediaFireLink = findSpecificLink(fullPageHtml, /(https?:\/\/www\.mediafire\.com\/[^"'\s<>]+)/i);

          // Ø§Ú¯Ø± Ù„Ù†Ú© ØºÙ„Ø·ÛŒ Ø³Û’ Ø¨Ú¾ÛŒ 'fundingchoices' ÛÙˆ ØªÙˆ Ø§Ø³Û’ ØµØ§Ù Ú©Ø± Ø¯Û’
          if (gDriveLink.indexOf("fundingchoices") > -1) gDriveLink = "NA";

          var row = [
            escapeCsv(title), 
            gDriveLink, 
            mediaFireLink,
            postLink
          ];
          csvContent += row.join(",") + "\n";
          postsFound++;
        }
      }

      if (postsFound > 0) {
        var fileName = domainName + "_" + currentYear + "-" + (currentMonth + 1) + ".csv";
        folder.createFile(fileName, csvContent, MimeType.CSV);
        Logger.log("âœ… File Created: " + fileName + " (" + postsFound + " posts)");
      } else {
        Logger.log("âš ï¸ No posts found for this month on " + domainName);
      }

    } catch (e) {
      Logger.log("âŒ Error processing " + domainName + ": " + e.toString());
    }
  }
}

// ------------------------------------------
// ğŸ›  Ù†ÛŒØ§ RSS URL ÙÙ†Ú©Ø´Ù† (Ø²ÛŒØ§Ø¯Û Ù¾ÙˆØ³Ù¹Ø³ Ù„Ø§Ù†Û’ ÙˆØ§Ù„Ø§)
// ------------------------------------------
function getHighLimitRssUrl(baseUrl) {
  // Blogger Ú©Û’ Ù„ÛŒÛ’ max-results=500 Ø¨ÛØª Ø¶Ø±ÙˆØ±ÛŒ ÛÛ’
  var patterns = [
    "feeds/posts/default?alt=rss&max-results=500",  // Best for Blogger
    "feed/?paged=1",                                // Try for WordPress
    "feed/",
    "rss.xml"
  ];

  for (var i = 0; i < patterns.length; i++) {
    var testUrl = baseUrl + patterns[i];
    try {
      var resp = UrlFetchApp.fetch(testUrl, {muteHttpExceptions: true});
      if (resp.getResponseCode() == 200) {
        Logger.log("Using RSS Feed: " + testUrl);
        return testUrl;
      }
    } catch (e) {}
  }
  return null;
}

// ------------------------------------------
// ğŸ›  Ø³Ù…Ø§Ø±Ù¹ Ù„Ù†Ú© ÙØ§Ø¦Ù†ÚˆØ±
// ------------------------------------------
function findSpecificLink(html, regexPattern) {
  if (!html) return "NA";

  var match = html.match(regexPattern);
  if (match && match[0]) {
    // ØµÙØ§Ø¦ÛŒ: Ø¢Ø®Ø± Ø³Û’ ÙØ¶ÙˆÙ„ Ù†Ø´Ø§Ù†Ø§Øª ÛÙ¹Ø§Ø¦ÛŒÚº
    return match[0].replace(/[)\]]+$/, '').replace(/&quot;/g, '').replace(/&amp;/g, '&');
  }
  return "NA";
}

function escapeCsv(text) {
  if (!text) return "";
  text = text.replace(/"/g, '""');
  return '"' + text + '"';
}