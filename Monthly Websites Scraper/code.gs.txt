function saveSeparateCsvsDeepScan() {
  // ------------------------------------------
  // 1ï¸âƒ£ ÙˆÛŒØ¨ Ø³Ø§Ø¦Ù¹Ø³ Ú©ÛŒ Ù„Ø³Ù¹
  // ------------------------------------------
  var WEBSITES = [
    "https://digestlibrary.com/",
    "https://www.urdunovelbanks.com/"
  ];

  var FOLDER_ID = ""; 

  // ------------------------------------------
  // 2ï¸âƒ£ Ù…ÛŒÙ† Ú©ÙˆÚˆ
  // ------------------------------------------
  var now = new Date();
  var currentMonth = now.getMonth(); 
  var currentYear = now.getFullYear();
  var folder = DriveApp.getFolderById(FOLDER_ID);

  for (var w = 0; w < WEBSITES.length; w++) {
    var siteUrl = WEBSITES[w];
    if (siteUrl.charAt(siteUrl.length - 1) != '/') siteUrl += '/';
    
    var domainName = siteUrl.replace(/^https?:\/\//, '').replace(/^www\./, '').split('.')[0];
    Logger.log("------------\nScanning: " + domainName);

    var rssUrl = getValidRssUrl(siteUrl);
    
    if (!rssUrl) {
      Logger.log("âŒ Failed: RSS not found for " + domainName);
      continue;
    }

    var csvContent = "Title,Google Drive Link,MediaFire Link,Post URL\n";
    var postsFound = 0;

    try {
      var response = UrlFetchApp.fetch(rssUrl, {muteHttpExceptions: true});
      var xml = response.getContentText();
      var document = XmlService.parse(xml);
      var root = document.getRootElement();
      var channel = root.getChild('channel');
      var items = channel.getChildren('item');

      for (var i = 0; i < items.length; i++) {
        var item = items[i];
        
        var pubDateStr = item.getChildText('pubDate');
        var pubDate = new Date(pubDateStr);
        
        if (pubDate.getFullYear() === currentYear && pubDate.getMonth() === currentMonth) {
          
          var title = item.getChildText('title');
          var postLink = item.getChildText('link');

          Logger.log("Checking post: " + title);

          // ----------------------------------------------------
          // ğŸ”¥ DEEP SCAN: Ø§ØµÙ„ Ù¾ÛŒØ¬ Ú©Ú¾ÙˆÙ„ÛŒÚº
          // ----------------------------------------------------
          var fullPageHtml = "";
          try {
            Utilities.sleep(1000); 
            var pageResp = UrlFetchApp.fetch(postLink, {muteHttpExceptions: true});
            fullPageHtml = pageResp.getContentText();
          } catch(err) {
            Logger.log("Could not open page: " + postLink);
          }

          // ----------------------------------------------------
          // ğŸ”¥ NEW: ØµØ±Ù Ù…Ø®ØµÙˆØµ ÚˆÙˆÙ…ÛŒÙ†Ø² Ú©Ùˆ Ù¹Ø§Ø±Ú¯Ù¹ Ú©Ø±ÛŒÚº
          // ----------------------------------------------------
          
          // Ú¯ÙˆÚ¯Ù„ Ú©Û’ Ù„ÛŒÛ’: ØµØ±Ù drive.google ÛŒØ§ docs.google
          var gDriveLink = findSpecificLink(fullPageHtml, /(https?:\/\/(drive|docs)\.google\.com\/[^"'\s<>]+)/i);
          
          // Ù…ÛŒÚˆÛŒØ§ ÙØ§Ø¦Ø± Ú©Û’ Ù„ÛŒÛ’
          var mediaFireLink = findSpecificLink(fullPageHtml, /(https?:\/\/www\.mediafire\.com\/[^"'\s<>]+)/i);

          var row = [
            escapeCsv(title), 
            gDriveLink, 
            mediaFireLink,
            postLink
          ];
          csvContent += row.join(",") + "\n";
          postsFound++;
        }
      }

      if (postsFound > 0) {
        var fileName = domainName + "_" + currentYear + "-" + (currentMonth + 1) + ".csv";
        folder.createFile(fileName, csvContent, MimeType.CSV);
        Logger.log("âœ… File Created: " + fileName + " (" + postsFound + " posts)");
      } else {
        Logger.log("âš ï¸ No posts found for this month on " + domainName);
      }

    } catch (e) {
      Logger.log("âŒ Error processing " + domainName + ": " + e.toString());
    }
  }
}

// ------------------------------------------
// ğŸ›  Ù†ÛŒØ§ Ø§ÙˆØ± Ø¨ÛØªØ± Ù„Ù†Ú© ÙØ§Ø¦Ù†ÚˆØ± (Smart Regex)
// ------------------------------------------
function findSpecificLink(html, regexPattern) {
  if (!html) return "NA";

  var match = html.match(regexPattern);
  if (match && match[0]) {
    // Ù„Ù†Ú© Ú©ÛŒ ØµÙØ§Ø¦ÛŒ Ú©Ø±ÛŒÚº (Ø¢Ø®Ø± Ù…ÛŒÚº Ø¢Ù†Û’ ÙˆØ§Ù„Û’ Ø¨Ø±ÛŒÚ©Ù¹ ÛŒØ§ Ú©ÙˆÙ¹Ø³ ÛÙ¹Ø§Ø¦ÛŒÚº)
    return match[0].replace(/[)\]]+$/, '').replace(/&quot;/g, '').replace(/&amp;/g, '&');
  }
  return "NA";
}

function getValidRssUrl(baseUrl) {
  var patterns = ["feeds/posts/default?alt=rss", "feed/", "rss.xml", "atom.xml"];
  for (var i = 0; i < patterns.length; i++) {
    var testUrl = baseUrl + patterns[i];
    try {
      var resp = UrlFetchApp.fetch(testUrl, {muteHttpExceptions: true});
      if (resp.getResponseCode() == 200) return testUrl;
    } catch (e) {}
  }
  return null;
}

function escapeCsv(text) {
  if (!text) return "";
  text = text.replace(/"/g, '""');
  return '"' + text + '"';
}